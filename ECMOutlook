Public Stuff(5) As String
Sub InitGlobals()
'Need help? T.Wilson@mosman.nsw.gov.au -  - Tony Wilson - Mosman Council 2018
'for Stuff(1) enter your email
'for Stuff(2) enter the name of the temporary outlook ECM working folder in your email account tree (Inbox/zCi)
'for Stuff(3) enter the name of your outlook team subfolder (shared/personal)
'for Stuff(4) enter the email address for ECM (ECMConnect@domain.com)

    Stuff(1) = "myemail@domain.com”
    Stuff(2) = "zCi"
    Stuff(3) = "mySubFolder"
    Stuff(4) = “ECMConnect@domain.com”
Stuff(5) = "Organisation"

End Sub


Sub Default1()
    FirstMove
    Dim QAP As String
    QAP = " "
    ForwardDefault QAP
End Sub

Sub Address()
    FirstMove
    Dim QAP As String
    QAP = "#QAP 69"
    ForwardDefault QAP
End Sub

Sub Fire()
    FirstMove
    Dim QAP As String
    QAP = "#QAP 71"
    ForwardDefault QAP
End Sub

Sub ResidentSub()
    FirstMove
    Dim QAP As String
    QAP = "#QAP 210"
    ForwardDefault QAP
End Sub

Sub Job()
    FirstMove
    Dim QAP As String
    QAP = "#QAP 224"
    ForwardDefault QAP
End Sub

Sub ParkingIllegal()
    FirstMove
    Dim QAP As String
    QAP = "#QAP 302"
    ForwardDefault QAP
End Sub

Sub FirstMove()
   Call InitGlobals
    Dim objOutlook As Outlook.Application
    Dim objNamespace As Outlook.NameSpace
    Dim objSourceFolder As Outlook.MAPIFolder
    Dim objDestFolder As Outlook.MAPIFolder
    Dim objItem As MailItem
    Dim ECMaddress As String
    Dim objMail As Outlook.MailItem
    Dim strbody As String
    Dim oldmsg As String
    Dim senderaddress As String
    Dim addresstype As Integer
    Dim oAccount As Outlook.Account
    Set objOutlook = Application
    Set objNamespace = objOutlook.GetNamespace("MAPI")
    Set objSourceFolder = objNamespace.GetDefaultFolder(olFolderDrafts)
    Set objItem = objOutlook.ActiveExplorer.Selection.Item(1)
    Set oAccount = Application.Session.Accounts(Stuff(1))
'

    Set objDestFolder = objNamespace.Folders(Stuff(1)).Folders("Inbox").Folders(Stuff(2))
'
'
    objItem.UnRead = False
    objItem.Move objDestFolder
End Sub

Sub ForwardDefault(QAP As String)
    Dim objPropertyAccessor As Outlook.PropertyAccessor
    Dim strHeader As String
    Dim strTempFolder As String
    Dim objFileSystem As Object
    Dim strTextFile As String
    Dim objTextFile As Object
    Dim objOutlook As Outlook.Application
    Dim objNamespace As Outlook.NameSpace
    Dim objSourceFolder As Outlook.MAPIFolder
    Dim objDestFolder As Outlook.MAPIFolder
    Dim objItem As MailItem
    Dim ECMaddress As String
    Dim objMail As Outlook.MailItem
    Dim strbody As String
    Dim oldmsg As String
    Dim senderaddress As String
    Dim addresstype As Integer
    Dim oAccount As Outlook.Account
    Dim objCouncilFolder As Outlook.MAPIFolder
    Set objOutlook = Application
    Set objNamespace = objOutlook.GetNamespace("MAPI")
    Set objSourceFolder = objNamespace.GetDefaultFolder(olFolderDrafts)
'
    Set objDestFolder = objNamespace.Folders(Stuff(1)).Folders("Inbox").Folders(Stuff(2))
'
    Set objCouncilFolder = objNamespace.Folders(Stuff(5)).Folders("Inbox").Folders(Stuff(3))
'
    ECMaddress = Stuff(4)
'
    Dim objItems As Outlook.Items
    Set objItems = objDestFolder.Items
    For Each obj In objItems
    With obj
    Set objMail = obj.Forward
    Set objPropertyAccessor = obj.PropertyAccessor
    strHeader = objPropertyAccessor.GetProperty("http://schemas.microsoft.com/mapi/proptag/0x007D001E")
    'Option for including internet headers as attachment - Currently ECM woudl print them at pdf exports
    'strTempFolder = Environ("Temp")
    'Set objFileSystem = CreateObject("Scripting.FileSystemObject")
    'strTextFile = strTempFolder & "\Internet Headers.txt"
    'Set objTextFile = objFileSystem.CreateTextFile(strTextFile)
    'objTextFile.Write strHeader
    'objTextFile.Close
    objMail.To = ECMaddress
    'objMail.Attachments.Add (strTextFile)
    objMail.Subject = obj.Subject
'
    strbody = "<font size=""1"" color=""white"">" + "<br>" + "#ECMBODY" + "<br>" + "#SILENT" + "<br>" + QAP + "<br>" + "#NOREG" + "<br>" + strHeader + "</font>"
    objMail.HTMLBody = objMail.HTMLBody + strbody
'
    objMail.Send
    obj.Move objCouncilFolder
    End With
    Next
    Set objItem = Nothing
    Set objMail = Nothing
End Sub
